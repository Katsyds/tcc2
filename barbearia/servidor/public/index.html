<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Barbearia</title>
</head>
<body>
    <header>
        <nav>
            <div class="logo">Barbearia Tradicional</div>
            <ul>
                <li><a href="#about">Sobre Nós</a></li>
                <li><a href="#services">Serviços</a></li>
                <li><a href="#gallery">Galeria</a></li>
                <li><a href="#testimonials">Depoimentos</a></li>
                <li><a href="#contact">Contato</a></li>
            </ul>
        </nav>
    </header>

    <section id="hero">
        <div class="hero-content">
            <div class="banner">
            <div class="content-container">
            <h1>Seja Bem-Vindo à Nossa Barbearia</h1>
            <p>Experimente nossos serviços premium para um visual impecável.</p>
            <a href="#contact" class="btn">Agende um Horário</a>
            </div>
            </div>
        </div>
    </section>

    <section id="about" class="content-block">
        <h2>Sobre Nós</h2>
        <p>Oferecemos os melhores serviços de barbearia, com uma equipe experiente e produtos de qualidade.</p>
    </section>

    <section id="services" class="content-block">
        <h2>Serviços</h2>
        <ul class="services-list">
            <li><span class="service-icon">&#9733;</span> Corte de Cabelo</li>
            <li><span class="service-icon">&#9733;</span> Barba e Bigode</li>
            <li><span class="service-icon">&#9733;</span> Tratamentos Faciais</li>
            <li><span class="service-icon">&#9733;</span> Massagem Capilar</li>
        </ul>
    </section>

    <section id="gallery" class="content-block">
        <h2>Galeria</h2>
        <div class="image-gallery">
            <img src="img/img4.jpg" alt="Serviço 1">
            <img src="img/img2.jpg" alt="Serviço 2">
            <img src="img/img5.jpg" alt="Serviço 3">
            <!-- Adicione mais imagens aqui -->
        </div>
    </section>

    <section id="testimonials" class="content-block">
        <h2>Depoimentos</h2>
        <div class="testimonial">
            <blockquote>
                "Excelente atendimento e profissionais competentes. Sempre saio satisfeito!"
            </blockquote>
            <p>- Cliente Satisfeito</p>
        </div>
        <div class="testimonial">
            <blockquote>
                "A barbearia oferece um ambiente acolhedor e os cortes de cabelo são impecáveis."
            </blockquote>
            <p>- Cliente Feliz</p>
        </div>
    </section>

    <section id="contact" class="content-block">
        <form id="reservation-form">
            <h3>Agende um Horário</h3>
            <label for="name">Nome:</label>
            <input type="text" id="name" name="name" required>
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
            <label for="service">Serviço:</label>
            <select id="service" name="service" required>
                <option value="corte">Corte de Cabelo</option>
                <option value="barba">Barba</option>
                <option value="cortebarba">Corte e Barba</option>
            </select>
            <label for="date">Data:</label>
            <input type="date" id="date" name="date" required>
            
            <label for="time">Horário:</label>
            <div id="horario-buttons">
              <button class="horario-button" id="horario-10">10:00</button>
              <button class="horario-button" id="horario-11">11:00</button>
              <button class="horario-button" id="horario-12">12:00</button>
              <button class="horario-button" id="horario-13">13:00</button>
              <button class="horario-button" id="horario-14">14:00</button>
              <button class="horario-button" id="horario-15">15:00</button> 
              <button class="horario-button" id="horario-16">16:00</button> 
              <button class="horario-button" id="horario-17">17:00</button> 
              <!-- Adicione mais botões para outros horários -->
            </div>
            <button type="submit" class="btn">Agendar</button>
        </form>
    </section>

    <footer>
        <p>&copy; 2023 Barbearia Tradicional. Todos os direitos reservados.</p>
    </footer>
    <script>
       document.getElementById('reservation-form').addEventListener('submit', async function (event) {
    event.preventDefault();

    const nome = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const servico = document.getElementById('service').value;
    const data = document.getElementById('date').value;

    // Obtém todos os botões de horário
    const buttons = document.querySelectorAll('.horario-button');

    // Encontra o botão selecionado
    const horarioSelecionadoButton = Array.from(buttons).find(button => button.classList.contains('selecionado'));

    if (!horarioSelecionadoButton) {
        alert('Por favor, selecione um horário disponível.');
        return; // Não continue o envio do formulário se nenhum horário estiver selecionado
    }

    const horario = horarioSelecionadoButton.textContent;

    // Se todas as validações passarem, enviar o formulário
    const agendamentoData = {
        nome,
        email,
        servico,
        data,
        horario
    };

    try {
        const response = await fetch('/agendamento', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(agendamentoData),
        });

        if (response.ok) {
            const message = await response.text();
            console.log(message);
        } else {
            console.error('Erro ao enviar o formulário de agendamento.');
        }
    } catch (error) {
        console.error('Erro ao processar a solicitação:', error);
    }
});

// Restante do código permanece o mesmo


        // Função para verificar se um horário está ocupado para uma data
        async function verificarHorarioOcupado(data, horario) {
            const response = await fetch('/verificarHorarioOcupado', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ data, horario }),
            });

            if (response.ok) {
                const resultado = await response.json();
                return resultado.ocupado;
            } else {
                console.error('Erro ao verificar horário ocupado.');
                return false;
            }
        }

        // Adicione um ouvinte de evento a cada botão de horário
        const buttons = document.querySelectorAll('.horario-button');
        buttons.forEach(button => {
            button.addEventListener('click', async () => {
                const horario = button.textContent; // Obtém o horário do botão clicado
                const data = document.getElementById('date').value; // Obtém a data selecionada

                const horarioOcupado = await verificarHorarioOcupado(data, horario);

                if (horarioOcupado) {
                    alert('Este horário já está ocupado para esta data.');
                } else {
                    // Realce o botão selecionado para indicar a seleção
                    buttons.forEach(btn => {
                        btn.classList.remove('selecionado');
                    });

                    button.classList.add('selecionado');
                }
            });
        });

        // Adicione uma função para limpar a seleção quando a data é alterada
        document.getElementById('date').addEventListener('change', () => {
            buttons.forEach(button => {
                button.classList.remove('selecionado');
            });
        });
    </script>
</body>
</html>
